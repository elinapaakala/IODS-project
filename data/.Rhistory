a+b+d+e
51 %% 7
49 %% 7
v1=c(12,2,-5,6,34)
v1
v2=seq(0,100, by=5)
v2
v3=c(v1, v2)
v3
v3>3
v3<50
v4=v3[v3>3] & v3[v3<50]
v4
A=matrix(c(3,5,6,0.5,sqrt(5),16,0,2,0), ncol=3, nrow=3, byrow=TRUE)
A
t(A)
B=A%*%c(1,1,0)
B
I=matrix(c(1,0,0,0,1,0,0,0,1), ncol=3, nrow=3, byrow=TRUE)
I
A%*%I
A*I
C=matrix(c(runif(20, min=1, max=20)), ncol=4)
length(C[C<5])
C[C<5] <- 12
C
C[,c(F,T,T,T)]
C[c(T,T,T,T,F),]
D=matrix(1:100, ncol=2)
D[D %% 2 == 0] <- NA
D
D[is.na(D)] <- 0
D
nrow(x2corr)
nrow(x2)
load("J:/March2016/Analysis/Out_PCA_AYRS_454")
output.pca2$eig
output.pca2 = PCA(x_pca2, scale.unit=FALSE, ncp=5, graph=T)
library(FactoMineR)
output.pca2 = PCA(x_pca2, scale.unit=FALSE, ncp=5, graph=T)
plot.PCA(output.pca2, axes=c(1,2), choix="var")
ls(output.pca2$ind)
output.pca2$ind
output.pca2$eig
wss2 <- (nrow(output.pca2$ind$coord)-1)*sum(apply(output.pca2$ind$coord,2,var))
for (i in 2:20) wss2[i] <- sum(kmeans(output.pca2$ind$coord, centers=i)$withinss)
plot(1:20, wss2, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares",main="Best number of cluster for Bulls PCs")
means23
means23=aggregate(output.pca2$ind$coord,by=list(fit23$cluster),FUN=mean)
means23
fit23 = kmeans(output.pca2$ind$coord, 3)
means23=aggregate(output.pca2$ind$coord,by=list(fit23$cluster),FUN=mean)
means23
‘citation("pkgname")’
citation("pkgname")
citation("corrgram")
citation("FactoMiner")
library(FactoMineR)
citation("FactoMiner")
citation("FactoMineR")
plot(fit3$cluster)
fit3 = kmeans(output.pca2$ind$coord, 3)
plot(fit3$cluster)
library(cluster)
clusplot(means3, fit3$cluster, color=TRUE, shade=TRUE,
labels=2, lines=0)
means3=aggregate(output.pca2$ind$coord,by=list(fit3$cluster),FUN=mean)
library(cluster)
clusplot(means3, fit3$cluster, color=TRUE, shade=TRUE,
labels=2, lines=0)
clusplot(means3, fit3$cluster, color=TRUE, shade=TRUE,
labels=2, lines=0)
pcacoord.indv
output.pca2 = PCA(x_pca2, scale.unit=FALSE, ncp=5, graph=T)
clusplot(means_3pcacluster_HOL_503, fit3$cluster, color=TRUE, shade=TRUE,
labels=2, lines=0)
fit23 = kmeans(output.pca2$ind$coord, 3)
wss2 <- (nrow(output.pca2$ind$coord)-1)*sum(apply(output.pca2$ind$coord,2,var))
for (i in 2:20) wss2[i] <- sum(kmeans(output.pca2$ind$coord, centers=i)$withinss)
plot(1:20, wss2, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares",main="Best number of cluster for Bulls PCs")
plot.PCA(output.pca2, axes=c(1,2), choix="var")
clusplot(means_3pcacluster_AYRS_454, fit3$cluster, color=TRUE, shade=TRUE,
labels=2, lines=0)
load("J:/March2016/Analysis/out_pca3cluster_AYRS_454")
clusplot(out_bulls3clusters_AYRS_454, fit3$cluster, color=TRUE, shade=TRUE,
labels=2, lines=0)
out_bulls3clusters_AYRS_454 <- read.table("J:/March2016/Analysis/out_bulls3clusters_AYRS_454", quote="\"", comment.char="")
View(out_bulls3clusters_AYRS_454)
clusplot(out_bulls3clusters_AYRS_454, fit3$cluster, color=TRUE, shade=TRUE,
labels=2, lines=0)
clusplot(fit3$cluster, out_bulls3clusters_AYRS_454, color=TRUE, shade=TRUE,
labels=2, lines=0)
clusplot(out_bulls3clusters_AYRS_454, color=TRUE, shade=TRUE,
labels=2, lines=0)
plot(out_bulls3clusters_AYRS_454)
table(fit3$cluster)
means_3pcacluster_AYRS_454 <- read.delim2("J:/March2016/Analysis/means_3pcacluster_AYRS_454")
View(means_3pcacluster_AYRS_454)
FINALFILE_3clust_AYRS_454 <- read.csv("J:/March2016/Analysis/FINALFILE_3clust_AYRS_454", sep="")
View(FINALFILE_3clust_AYRS_454)
y=FINALFILE_3clust_AYRS_454
library(MASS)
fit <- lda(cluster ~ + Growth +	MilkAb+	Temperament+
HealthOther	+HealthUdder+	HealthFert+	ConformUdder+	ConformBody+	Longevity	+
ProdCombined	+ConformLeg+	Birth	+Calving+	ClawHealth, data=y,
na.action="na.omit", CV=TRUE)
output.pca2 = PCA(x_pca2, scale.unit=FALSE, ncp=5, graph=T)
library(FactoMineR)
output.pca2 = PCA(x_pca2, scale.unit=FALSE, ncp=5, graph=T)
load("J:/March2016/Analysis/Out_PCA_AYRS_454")
ls(output.pca2)
plot.PCA(output.pca2, axes=c(1,2), choix="var")
View(y)
fit <- lda(fit23.cluster ~ Growth +	MilkAb+	Temperament+
HealthOther	+HealthUdder+	HealthFert+	ConformUdder+	ConformBody+	Longevity	+
ProdCombined	+ConformLeg+	Birth	+Calving+	ClawHealth, data=y,
na.action="na.omit", CV=TRUE)
fit # show results
ct <- table(y$fit23.cluster, fit$class)
diag(prop.table(ct, 1))
sum(diag(prop.table(ct)))
fit # show results
diag(prop.table(ct, 3))
diag(prop.table(ct, 1))
prop.table(ct)
prop.table(ct, 1)
fit2 <- lda(fit23.cluster ~ Growth + Longevity	+ ProdCombined, data=y,
na.action="na.omit", CV=TRUE)
fit2 # show results
ct2 <- table(y$fit23.cluster, fit2$class)
prop.table(ct2, 1)
fit3 <- lda(fit23.cluster ~ Longevity	+ Growth + ProdCombined, data=y,
na.action="na.omit", CV=TRUE)
fit3 # show results
ct3 <- table(y$fit23.cluster, fit3$class)
prop.table(ct3, 1)
prop.table(ct, 1)
prop.table(ct2, 1)
prop.table(ct3, 1)
fit3 <- lda(fit23.cluster ~ Longevity	+ ConformLeg + Birth, data=y,
na.action="na.omit", CV=TRUE)
ct3 <- table(y$fit23.cluster, fit3$class)
diag(prop.table(ct3, 1))
prop.table(ct3, 1)
prop.table(ct, 1)
sum(diag(prop.table(ct)))
prop.table(ct2, 1)
# total percent correct
sum(diag(prop.table(ct2)))
prop.table(ct3, 1)
# total percent correct
sum(diag(prop.table(ct3)))
fit3 # show results
fit2 <- lda(fit23.cluster ~ Growth + Longevity	+ ProdCombined + ClawHealth + ConformUdder, data=y,
na.action="na.omit", CV=TRUE)
fit2 # show results
# Assess the accuracy of the prediction
# percent correct for each category of G
ct2 <- table(y$fit23.cluster, fit2$class)
diag(prop.table(ct2, 1))
prop.table(ct2, 1)
# total percent correct
sum(diag(prop.table(ct2)))
fit4 <- lda(fit23.cluster ~ Longevity	+ ConformLeg + Birth + Growth + ProdCombined, data=y,
na.action="na.omit", CV=TRUE)
fit4 # show results
# Assess the accuracy of the prediction
# percent correct for each category of G
ct4 <- table(y$fit23.cluster, fit4$class)
diag(prop.table(ct4, 1))
prop.table(ct4, 1)
# total percent correct
sum(diag(prop.table(ct4)))
sum(diag(prop.table(ct)))
AYHerdBulls <- read.delim("J:/March2016/Analysis/AYHerdBulls.txt")
View(AYHerdBulls)
y=AYHerdBulls
farmeans=aggregate(y[, 39:60], list(y$Idkar), mean, na.rm=T)
library(reshape)
install.packages("reshape")
library(reshape)
a <- rename(a, farmeans(Group.1="Idkar"))
View(farmeans)
a=farmeans
a <- rename(a, farmeans(Group.1="Idkar"))
library(plyr)
rename(a, c("Group.1"="Idkar"))
farmeans=aggregate(y[, 39:60], list(y$Idkar), mean, na.rm=T)
View(farmeans)
library(reshape)
a <- rename(a, farmeans(Group.1="Idkar"))
a <- rename(a, farmeans$Group.1="Idkar"))
a <- rename(a, farmeans$Group.1="Idkar")
a=farmeans
a <- rename(a$Group.1="Idkar")
colnames(Group.1) <- "Idkar"
farmeans=aggregate(y[, 39:60], list(y$Idkar), mean, na.rm=T)
a <- rename(farmeans(Group.1="Idkar"))
a=farmeans
colnames(a$Group.1) <- "Idkar"
names(a)[names(a)=="Group.1"] <- "Idkar"
head(farmeans)
head(a)
b=merge(a,y,by="Idkar", all=F)
library(dplyr)
c=left.join(a,y,by="Idkar")
View(b)
fit4 <- lda(fit23.cluster ~ Longevity	+ ConformLeg + Birth + Growth + ProdCombined, data=y,
na.action="na.omit", CV=TRUE)
fit4 # show results
# Assess the accuracy of the prediction
# percent correct for each category of G
ct4 <- table(y$fit23.cluster, fit4$class)
diag(prop.table(ct4, 1))
prop.table(ct4, 1)
fit4 <- lda(fit23.cluster ~ Longevity	+ ConformUdder + Birth + Growth + ProdCombined, data=y,
na.action="na.omit", CV=TRUE)
fit4 # show results
# Assess the accuracy of the prediction
# percent correct for each category of G
ct4 <- table(y$fit23.cluster, fit4$class)
diag(prop.table(ct4, 1))
prop.table(ct4, 1)
fit4 <- lda(fit23.cluster ~ HealthUdder	+ ConformUdder + Birth + Growth + ProdCombined, data=y,
na.action="na.omit", CV=TRUE)
fit4 # show results
# Assess the accuracy of the prediction
# percent correct for each category of G
ct4 <- table(y$fit23.cluster, fit4$class)
diag(prop.table(ct4, 1))
prop.table(ct4, 1)
# total percent correct
sum(diag(prop.table(ct4)))
fit <- lda(fit23.cluster ~ Growth +	MilkAb+	Temperament+
HealthOther	+HealthUdder+	HealthFert+	ConformUdder+	ConformBody+	Longevity	+
ProdCombined	+ConformLeg+	Birth	+Calving+	ClawHealth, data=y,
na.action="na.omit", CV=TRUE)
fit # show results
# Assess the accuracy of the prediction
# percent correct for each category of G
ct <- table(y$fit23.cluster, fit$class)
diag(prop.table(ct, 1))
prop.table(ct, 1)
# total percent correct
sum(diag(prop.table(ct)))
fit # show results
load("J:/March2016/Analysis/Out_PCA_AYRS_454")
ls(output.pca2)
output.pca2$eig
output.pca2$ind
ls(output.pca2$ind)
ls(output.pca2$ind$coord)
output.pca2$ind$coord
output.pca2$ind$contrib
ls(output.pca2$ind)
output.pca2$dist
output.pca2$ind$dist
ls(output.pca2)
output.pca2$svd
output.pca2$var
head(a)
library(dplyr)
c=left.join(a,y,by="Idkar")
FarmMeanEbvs <- read.csv("J:/March2016/Analysis/FarmMeanEbvs.txt", sep="")
View(FarmMeanEbvs)
FarmSystem2 <- read.csv("J:/March2016/Analysis/FarmSystem2.txt", sep="")
View(FarmSystem2)
a=merge(FarmSystem2, FarmMeanEbvs, by="Idkar")
head(a)
library(MASS)
View(a)
View(FarmMeanEbvs)
View(FarmSystem2)
a=merge(FarmMeanEbvs, FarmSystem2, by="Idkar")
View(FarmSystem2)
FarmSystems3=FarmSystems3[!FarmSystems3(x[,1]),]
FarmSystem3=FarmSystem2[!FarmSystem2(x[,1]),]
FarmSystem3=FarmSystem2[!dublicated(FarmSystem2[,1]),]
library(corrgram)
x2=x[!duplicated(x[,38]),]
FarmSystem3=FarmSystem2[!dublicated(FarmSystem2[,1]),]
FarmSystem3=FarmSystem2[!dublicated(FarmSystem2[,1]),]
a2=a[!dublicated(a[,1]),]
FarmSystem3=FarmSystem2[!duplicated(FarmSystem2[,1]),]
a=merge(FarmMeanEbvs, FarmSystem2, by="Idkar")
a=merge(FarmMeanEbvs, FarmSystem3, by="Idkar")
a=5+12
a
v4=v3[v3>3] & v3[v3<50]
v4
v4 <- v3[v3>3 & v3<50]
v4
t(A)
B=A%*%c(1,1,0)
B
B <- solve(A) %*% matrix(c(1,1,0))
B
I=matrix(c(1,0,0,0,1,0,0,0,1), ncol=3, nrow=3, byrow=TRUE)
I
I <- diag(3)
I
D=matrix(1:100, ncol=2)
D[D %% 2 == 0] <- NA
D
D[is.na(D)] <- 0
D
D[is.na(D)==T] <- 0
D
C[C<5] <- rep(12,lukuja)
C <- C[,c(F,T,T,T)]
C <- C[c(T,T,T,T,F),]
C
C <- C[c(T,T,T,T,F),c(F,T,T,T)]
v4 <- c(v3[v3 < 3], v3[v3 > 50])
v4
C <- matrix(c(runif(20, min = 1, max=20)), ncol=4)
length(C[C<5])
#Tehtävä 10
C[C<5]<-12
#Tehtävä 11
C[c(T,T,F),c(F,T,T)]
C=matrix(c(runif(20, min=1, max=20)), ncol=4)
length(C[C<5])
#Tehtävä10
C[C<5] <- 12
C
#Tehtävä11
C[,c(F,T,T,T)]
C[c(T,T,T,T,F),]
C[,c(F,T,T,T)], C[c(T,T,T,T,F),]
C[,c(F,T,T,T), c(T,T,T,T,F),]
C[c(F,T,T,T), c(T,T,T,T,F)]
Herds.by.4.clusters_AYHerd_pca2 <- read.csv("H:/Jatko-opinnot/Data/2015 siemennystiedot/Analyysit/Karjakohtaiset analyysit/AY/AY yli 90%/Herds by 4 clusters_AYHerd_pca2", sep="")
View(Herds.by.4.clusters_AYHerd_pca2)
tapply(Herds.by.4.clusters_AYHerd_pca2$MCN, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$MCN, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
is.numeric(Herds.by.4.clusters_AYHerd_pca2$MCN)
tapply(Herds.by.4.clusters_AYHerd_pca2$CA, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
summary(Herds.by.4.clusters_AYHerd_pca2$MCN)
Herds.by.4.clusters_AYHerd_pca2$MCN<-as.numeric(as.character(Herds.by.4.clusters_AYHerd_pca2$MCN))
tapply(Herds.by.4.clusters_AYHerd_pca2$MCN, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$AD, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
table(Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, Herds.by.4.clusters_AYHerd_pca2$BARN)
summary(Herds.by.4.clusters_AYHerd_pca2$fit4.cluster)
table(Herds.by.4.clusters_AYHerd_pca2$fit4.cluster)
tapply(Herds.by.4.clusters_AYHerd_pca2$Freq.y, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, sum, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$CAG, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$CONS, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$EET, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
table(Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, Herds.by.4.clusters_AYHerd_pca2$FEED)
tapply(Herds.by.4.clusters_AYHerd_pca2$IC, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$INV, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$MI, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
table(Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, Herds.by.4.clusters_AYHerd_pca2$MM)
table(Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, Herds.by.4.clusters_AYHerd_pca2$ORG)
tapply(Herds.by.4.clusters_AYHerd_pca2$STK, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
table(Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, Herds.by.4.clusters_AYHerd_pca2$SUB)
tapply(Herds.by.4.clusters_AYHerd_pca2$LOP, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$EPP, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$EKM, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$KT1, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$PET, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$PP, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
tapply(Herds.by.4.clusters_AYHerd_pca2$SP, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
#vasikkakuolleisuus
tapply(Herds.by.4.clusters_AYHerd_pca2$VK, Herds.by.4.clusters_AYHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
Herds.by.4.clusters_HOLHerd_pca2 <- read.csv("H:/Jatko-opinnot/Data/2015 siemennystiedot/Analyysit/Karjakohtaiset analyysit/HOL yli 90%/Herds by 4 clusters_HOLHerd_pca2", sep="")
View(Herds.by.4.clusters_HOLHerd_pca2)
table(Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster)
tapply(Herds.by.4.clusters_HOLHerd_pca2$AD, Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
st.err <- function(x) {
sd(x)/sqrt(length(x))
}
aggregate(Herds.by.4.clusters_HOLHerd_pca2$AD ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$AD, na.rm=TRUE)
stderr <- function(x) sqrt(var(x,na.rm=TRUE)/length(na.omit(x)))
stderr(Herds.by.4.clusters_HOLHerd_pca2$AD)
tapply(Herds.by.4.clusters_HOLHerd_pca2$BV, Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$BV ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$BV, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$BV)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$CA ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$CA, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$CA)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$CAG ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$CAG, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$CAG)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$CN ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$CN, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$CN)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$CONS ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$CONS, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$CONS)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$EET ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$EET, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$EET)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$EKM ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$EKM, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$EKM)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$EEP ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$EEP, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$EEP)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$EPP ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$EPP, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$EPP)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$IC ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$IC, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$IC)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$INV ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$INV, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$INV)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$KT1 ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$KT1, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$KT1)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$LOP ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$LOP, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$LOP)
tapply(Herds.by.4.clusters_HOLHerd_pca2$MCN, Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, mean, na.rm=TRUE)
is.numeric(Herds.by.4.clusters_HOLHerd_pca2$MCN)
summary(Herds.by.4.clusters_HOLHerd_pca2$MCN)
Herds.by.4.clusters_HOLHerd_pca2$MCN<-as.numeric(as.character(Herds.by.4.clusters_HOLHerd_pca2$MCN))
aggregate(Herds.by.4.clusters_HOLHerd_pca2$MCN ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$MCN, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$MCN)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$MI ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$MI, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$MI)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$PET ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$PET, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$PET)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$PP ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$PP, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$PP)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$PR ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$PR, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$PR)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$SP ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$SP, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$SP)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$STK ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$STK, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$STK)
aggregate(Herds.by.4.clusters_HOLHerd_pca2$VK ~ Herds.by.4.clusters_HOLHerd_pca2$fit4.cluster, Herds.by.4.clusters_HOLHerd_pca2, st.err)
mean(Herds.by.4.clusters_HOLHerd_pca2$VK, na.rm=TRUE)
stderr(Herds.by.4.clusters_HOLHerd_pca2$VK)
student-mat <- read.table("H:/Jatko-opinnot/Open data science/IODS-project/data/student-mat", sep=",", header=TRUE)
setwd("H:/Jatko-opinnot/Open data science/IODS-project/data")
student-mat <- read.table("H:/Jatko-opinnot/Open data science/IODS-project/data/student-mat", sep=",", header=TRUE)
student-mat <- read.csv("H:/Jatko-opinnot/Open data science/IODS-project/data/student-mat", sep=",", header=TRUE)
student-mat <- read.csv("H:/Jatko-opinnot/Open data science/IODS-project/data/learning2014", sep=",", header=TRUE)
student-mat <- read.table("H:/Jatko-opinnot/Open data science/IODS-project/data/student-mat.csv", sep=",", header=TRUE)
studentmat <- read.table("H:/Jatko-opinnot/Open data science/IODS-project/data/student-mat.csv", sep=",", header=TRUE)
studentpor <- read.table("H:/Jatko-opinnot/Open data science/IODS-project/data/student-por", sep=",", header=TRUE)
studentpor <- read.table("H:/Jatko-opinnot/Open data science/IODS-project/data/student-por.csv", sep=",", header=TRUE)
str(studentmat)
dim(studentmat)
studentmat
studentmat <- read.table("H:/Jatko-opinnot/Open data science/IODS-project/data/student-mat.csv", sep="\t", header=TRUE)
str(studentmat)
dim(studentmat)
str(studentpor)
dim(studentpor)
studentmat <- read.table("H:/Jatko-opinnot/Open data science/IODS-project/data/student-mat", sep="\t", header=TRUE)
studentmat <- read.table("H:/Jatko-opinnot/Open data science/IODS-project/data/student-mat.csv", sep=";", header=TRUE)
studentpor <- read.table("H:/Jatko-opinnot/Open data science/IODS-project/data/student-por.csv", sep=";", header=TRUE)
str(studentmat)
dim(studentmat)
str(studentpor)
dim(studentpor)
library(dplyr)
join_by <- c("school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery","internet")
matpor <- inner_join(studentmat, studentpor, by = join_by, suffix = c(".math", ".por"))
str(matpor)
dim(matpor)
glimpse(matpor)
matpor <- inner_join(studentmat, studentpor, by = join_by)
str(matpor)
dim(matpor)
dim(studentmat)
dim(studentpor)
alc <- select(matpor, one_of(join_by))
notjoined_columns <- colnames(studentmat)[!colnames(studentmat) %in% join_by]
notjoined_columns
# for every column name not used for joining...
for(column_name in notjoined_columns) {
# select two columns from 'matpor' with the same original name
two_columns <- select(matpor, starts_with(column_name))
# select the first column vector of those two columns
first_column <- select(two_columns, 1)[[1]]
# if that first column vector is numeric...
if(is.numeric(first_column)) {
# take a rounded average of each row of the two columns and
# add the resulting vector to the alc data frame
alc[column_name] <- round(rowMeans(two_columns))
} else { # else if it's not numeric...
# add the first column vector to the alc data frame
alc[column_name] <- first_column
}
}
glimpse(alc)
dim(alc)
dim(studentmat)
dim(studentpor)
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
alc$alc_use
alc <- mutate(alc, high_use = alc_use > 2)
alc$high_use
glimpse(alc)
write.csv(alc, file = "alc")
install.packages("tidyr")
